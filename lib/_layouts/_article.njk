{% extends "_base.njk" %}

{% from "appArticle/macro.njk" import appArticle %}
{% from "appCard/macro.njk" import appCard with context %}
{% from "appIssuesheet/macro.njk" import appIssuesheet %}
{% from "prose/macro.njk" import appProse %}

{% block header %}
  {{ appArticleHeader({
    containerClasses: "nhsuk-width-container-fluid"
  }) }}
{% endblock %}

{% block content %}
  {% call appArticle({
    header: {
      title: title | widont
    },
    footer: {
      date: page.date,
      modified: modified if modified,
      review: review
    }
  }) %}
    <div class="nhsbsa-sticky-nav">
      <h2 class="nhsbsa-sticky-nav__heading">Contents</h2>
      {{ content | toc | safe }}
    </div>

    <div class="nhsbsa-article-content">
      <div class="nhsuk-back-link nhsuk-back-link-js">
        <a class="nhsuk-back-link__link" href="javascript:history.back()">
          <svg class="nhsuk-icon nhsuk-icon__chevron-left" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" height="24" width="24">
            <path d="M8.5 12c0-.3.1-.5.3-.7l5-5c.4-.4 1-.4 1.4 0s.4 1 0 1.4L10.9 12l4.3 4.3c.4.4.4 1 0 1.4s-1 .4-1.4 0l-5-5c-.2-.2-.3-.4-.3-.7z"></path>
          </svg>
          Go back</a>
      </div>
      
      <h1 class="nhsuk-heading-xl">
        {{ title }}
        {% if status and status != 'FINAL' %}
          [{{ status }}]
        {% endif %}
      </h1>
      
      {% call appIssuesheet({
        title: title,
        url: page.url,
        issuesheet: issuesheet,
        review: review,
        revisions: revisions
      }) %}
      {% endcall %}

      {% call appProse({
        prose: content
      }) -%}
      {% if related %}
      <h2 class="nhsuk-heading-l">
        {{ related.title or "Related articles" }}
      </h2>
      {{ appCard({
        items: collections[related.tag],
        order: related.tag
      }) }}
      {% endif %}
      {%- endcall %}
    </div>
  {% endcall %}
{% endblock %}
